<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="三唐"><meta name="description" content="Outline查看远程分支删除远程分支和tag删除不存在对应远程分支的本地分支重命名远程分支把本地tag推送到远程获取远程tag"><meta name="keywords" content="git"><title>Git查看、删除、重命名远程分支和tag · 三唐</title><link rel="icon" href="/favicon.ico"><link rel="canonical" href="http://yoursite.com/2016/02/02/Git查看、删除、重命名远程分支和tag/"><link rel="alternative" href="/atom.xml" title="三唐" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css"></head><body><div id="main"><header><a href="/." class="logo">三唐</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">Home</a></li><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/categories/" target="_self">Categories</a></li><li class="nav-link"><a href="/tags/" target="_self">Tags</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Git查看、删除、重命名远程分支和tag</h1><span class="post-time">Feb 2, 2016</span><div id="sidebar" class="post-sidebar"><h3 class="heading">Contents</h3><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Outline"><span class="toc-text">Outline</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#u67E5_u770B_u8FDC_u7A0B_u5206_u652F"><span class="toc-text">查看远程分支</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u5220_u9664_u8FDC_u7A0B_u5206_u652F_u548Ctag"><span class="toc-text">删除远程分支和tag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u5220_u9664_u4E0D_u5B58_u5728_u5BF9_u5E94_u8FDC_u7A0B_u5206_u652F_u7684_u672C_u5730_u5206_u652F"><span class="toc-text">删除不存在对应远程分支的本地分支</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u91CD_u547D_u540D_u8FDC_u7A0B_u5206_u652F"><span class="toc-text">重命名远程分支</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u628A_u672C_u5730tag_u63A8_u9001_u5230_u8FDC_u7A0B"><span class="toc-text">把本地tag推送到远程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u83B7_u53D6_u8FDC_u7A0Btag"><span class="toc-text">获取远程tag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u53C2_u8003_u6587_u7AE0"><span class="toc-text">参考文章</span></a></li></ol></li></ol></div><div class="post-content"><h1 id="Outline"><a href="#Outline" class="headerlink" title="Outline"></a>Outline</h1><ol>
<li>查看远程分支</li>
<li>删除远程分支和tag</li>
<li>删除不存在对应远程分支的本地分支</li>
<li>重命名远程分支</li>
<li>把本地tag推送到远程</li>
<li>获取远程tag</li>
</ol>
<a id="more"></a>
<h2 id="u67E5_u770B_u8FDC_u7A0B_u5206_u652F"><a href="#u67E5_u770B_u8FDC_u7A0B_u5206_u652F" class="headerlink" title="查看远程分支"></a>查看远程分支</h2><p>加上-a参数可以查看远程分支，远程分支会用红色表示出来（如果你开了颜色支持的话）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git branch <span class="operator">-a</span></span><br><span class="line">  master</span><br><span class="line">  remote</span><br><span class="line">  tungway</span><br><span class="line">  v1.<span class="number">52</span></span><br><span class="line">* zrong</span><br><span class="line">  remotes/origin/master</span><br><span class="line">  remotes/origin/tungway</span><br><span class="line">  remotes/origin/v1.<span class="number">52</span></span><br><span class="line">  remotes/origin/zrong</span><br></pre></td></tr></table></figure>
<h2 id="u5220_u9664_u8FDC_u7A0B_u5206_u652F_u548Ctag"><a href="#u5220_u9664_u8FDC_u7A0B_u5206_u652F_u548Ctag" class="headerlink" title="删除远程分支和tag"></a>删除远程分支和tag</h2><p>在Git v1.7.0 之后，可以使用这种语法删除远程分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin --delete &lt;branchName&gt;</span><br></pre></td></tr></table></figure>
<p>删除tag这么用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin --delete tag &lt;tagname&gt;</span><br></pre></td></tr></table></figure>
<!--more-->
<p>否则，可以使用这种语法，推送一个空分支到远程分支，其实就相当于删除远程分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin :&lt;branchName&gt;</span><br></pre></td></tr></table></figure>
<p>这是删除tag的方法，推送一个空tag到远程tag：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git tag <span class="operator">-d</span> &lt;tagname&gt;</span><br><span class="line">git push origin :refs/tags/&lt;tagname&gt;</span><br></pre></td></tr></table></figure>
<p>两种语法作用完全相同。</p>
<h2 id="u5220_u9664_u4E0D_u5B58_u5728_u5BF9_u5E94_u8FDC_u7A0B_u5206_u652F_u7684_u672C_u5730_u5206_u652F"><a href="#u5220_u9664_u4E0D_u5B58_u5728_u5BF9_u5E94_u8FDC_u7A0B_u5206_u652F_u7684_u672C_u5730_u5206_u652F" class="headerlink" title="删除不存在对应远程分支的本地分支"></a>删除不存在对应远程分支的本地分支</h2><p>假设这样一种情况：</p>
<ol>
<li>我创建了本地分支b1并pull到远程分支 <code>origin/b1</code>；</li>
<li>其他人在本地使用fetch或pull创建了本地的b1分支；</li>
<li>我删除了 <code>origin/b1</code> 远程分支；</li>
<li>其他人再次执行fetch或者pull并不会删除这个他们本地的 <code>b1</code> 分支，运行 <code>git branch -a</code> 也不能看出这个branch被删除了，如何处理？</li>
</ol>
<p>使用下面的代码查看b1的状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ git remote show origin</span><br><span class="line">* remote origin</span><br><span class="line">  Fetch URL: git@github.com:xxx/xxx.git</span><br><span class="line">  Push  URL: git@github.com:xxx/xxx.git</span><br><span class="line">  HEAD branch: master</span><br><span class="line">  Remote branches:</span><br><span class="line">    master                 tracked</span><br><span class="line">    refs/remotes/origin/b1 stale (use <span class="string">'git remote prune'</span> to remove)</span><br><span class="line">  Local branch configured <span class="keyword">for</span> <span class="string">'git pull'</span>:</span><br><span class="line">    master merges with remote master</span><br><span class="line">  Local ref configured <span class="keyword">for</span> <span class="string">'git push'</span>:</span><br><span class="line">    master pushes to master (up to date)</span><br></pre></td></tr></table></figure>
<p>这时候能够看到b1是stale的，使用 <code>git remote prune origin</code> 可以将其从本地版本库中去除。</p>
<p>更简单的方法是使用这个命令，它在fetch之后删除掉没有与远程分支对应的本地分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch -p</span><br></pre></td></tr></table></figure>
<h2 id="u91CD_u547D_u540D_u8FDC_u7A0B_u5206_u652F"><a href="#u91CD_u547D_u540D_u8FDC_u7A0B_u5206_u652F" class="headerlink" title="重命名远程分支"></a>重命名远程分支</h2><p>在git中重命名远程分支，其实就是先删除远程分支，然后重命名本地分支，再重新提交一个远程分支。</p>
<p>例如下面的例子中，我需要把 devel 分支重命名为 develop 分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -av</span><br><span class="line">* devel                             <span class="number">752</span>bb84 Merge pull request <span class="comment">#158 from Gwill/devel</span></span><br><span class="line">  master                            <span class="number">53</span>b27b8 Merge pull request <span class="comment">#138 from tdlrobin/master</span></span><br><span class="line">  zrong                             <span class="number">2</span>ae98d8 modify CCFileUtils, <span class="built_in">export</span> getFileData</span><br><span class="line">  remotes/origin/HEAD               -&gt; origin/master</span><br><span class="line">  remotes/origin/add_build_script   d4a8c4f Merge branch <span class="string">'master'</span> into add_build_script</span><br><span class="line">  remotes/origin/devel              <span class="number">752</span>bb84 Merge pull request <span class="comment">#158 from Gwill/devel</span></span><br><span class="line">  remotes/origin/devel_qt51         <span class="number">62208</span>f1 update .gitignore</span><br><span class="line">  remotes/origin/master             <span class="number">53</span>b27b8 Merge pull request <span class="comment">#138 from tdlrobin/master</span></span><br><span class="line">  remotes/origin/zrong              <span class="number">2</span>ae98d8 modify CCFileUtils, <span class="built_in">export</span> getFileData</span><br></pre></td></tr></table></figure>
<p>删除远程分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git push --delete origin devel</span><br><span class="line">To git@github.com:zrong/quick-cocos2d-x.git</span><br><span class="line"> - [deleted]         devel</span><br></pre></td></tr></table></figure>
<p>重命名本地分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -m devel develop</span><br></pre></td></tr></table></figure>
<p>推送本地分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin develop</span><br><span class="line">Counting objects: <span class="number">92</span>, done.</span><br><span class="line">Delta compression using up to <span class="number">4</span> threads.</span><br><span class="line">Compressing objects: <span class="number">100</span>% (<span class="number">48</span>/<span class="number">48</span>), done.</span><br><span class="line">Writing objects: <span class="number">100</span>% (<span class="number">58</span>/<span class="number">58</span>), <span class="number">1.38</span> MiB, done.</span><br><span class="line">Total <span class="number">58</span> (delta <span class="number">34</span>), reused <span class="number">12</span> (delta <span class="number">5</span>)</span><br><span class="line">To git@github.com:zrong/quick-cocos2d-x.git</span><br><span class="line"> * [new branch]      develop -&gt; develop</span><br></pre></td></tr></table></figure>
<p>然而，在 github 上操作的时候，我在删除远程分支时碰到这个错误：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git push --delete origin devel</span><br><span class="line">remote: error: refusing to delete the current branch: refs/heads/devel</span><br><span class="line">To git@github.com:zrong/quick-cocos2d-x.git</span><br><span class="line"> ! [remote rejected] devel (deletion of the current branch prohibited)</span><br><span class="line">error: failed to push some refs to <span class="string">'git@github.com:zrong/quick-cocos2d-x.git'</span></span><br></pre></td></tr></table></figure>
<p>这是由于在 github 中，devel 是项目的默认分支。要解决此问题，这样操作：</p>
<ol>
<li>进入 github 中该项目的 Settings 页面；</li>
<li>设置 Default Branch 为其他的分支（例如 master）；</li>
<li>重新执行删除远程分支命令。</li>
</ol>
<h2 id="u628A_u672C_u5730tag_u63A8_u9001_u5230_u8FDC_u7A0B"><a href="#u628A_u672C_u5730tag_u63A8_u9001_u5230_u8FDC_u7A0B" class="headerlink" title="把本地tag推送到远程"></a>把本地tag推送到远程</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push --tags</span><br></pre></td></tr></table></figure>
<h2 id="u83B7_u53D6_u8FDC_u7A0Btag"><a href="#u83B7_u53D6_u8FDC_u7A0Btag" class="headerlink" title="获取远程tag"></a>获取远程tag</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin tag &lt;tagname&gt;</span><br></pre></td></tr></table></figure>
<h2 id="u53C2_u8003_u6587_u7AE0"><a href="#u53C2_u8003_u6587_u7AE0" class="headerlink" title="参考文章"></a>参考文章</h2><ul>
<li><a href="https://makandracards.com/makandra/621-git-delete-a-branch-local-or-remote" target="_blank" rel="external">https://makandracards.com/makandra/621-git-delete-a-branch-local-or-remote</a></li>
<li><a href="http://stackoverflow.com/questions/2003505/how-do-i-delete-a-git-branch-both-locally-and-in-github" target="_blank" rel="external">http://stackoverflow.com/questions/2003505/how-do-i-delete-a-git-branch-both-locally-and-in-github</a></li>
<li><a href="http://www.cnblogs.com/deepnighttwo/archive/2011/06/18/2084438.html" target="_blank" rel="external">http://www.cnblogs.com/deepnighttwo/archive/2011/06/18/2084438.html</a></li>
<li><a href="http://stackoverflow.com/questions/14040754/deleting-remote-master-branch-refused-due-to-being-current-branch" target="_blank" rel="external">http://stackoverflow.com/questions/14040754/deleting-remote-master-branch-refused-due-to-being-current-branch</a></li>
<li><a href="http://weli.iteye.com/blog/1441582" target="_blank" rel="external">http://weli.iteye.com/blog/1441582</a></li>
<li><a href="http://zengrong.net/post/1746.htm" target="_blank" rel="external">http://zengrong.net/post/1746.htm</a></li>
</ul>
</div></article><div class="tags"><a href="/tags/git/">git</a></div><div class="paginator"><a href="/2016/02/03/RESTAPI-Reference/" class="prev"><i class="iconfont icon-left"></i><span> Prev</span></a></div><section id="comments"><div id="disqus_thread"></div></section><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://yoursite.com/2016/02/02/Git查看、删除、重命名远程分支和tag/';
    this.page.identifier = '2016/02/02/Git查看、删除、重命名远程分支和tag/';
    this.page.title = 'Git查看、删除、重命名远程分支和tag';
};
(function() {
var d = document, s = d.createElement('script');

s.src = '//santang.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();</script></section><footer><div class="social"><a href="mailto:daveztong@gmail.com" title="email" class="iconfont icon-email"></a><a href="http://stackoverflow.com/users/1388881/daveztong" title="stack-overflow" class="iconfont icon-stack-overflow"></a><a href="/atom.xml" title="rss" class="iconfont icon-rss"></a></div><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">三唐</span></p></div><div id="back2top"><i class="iconfont icon-up"></i></div></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></body></html>